# ğŸ§  VANILLA NEST-LIKE BACKEND TEMPLATE

	Backend template em **Node.js (ESM)** com **Express 5**, **Prisma (PostgreSQL)**, **JWT Auth**, **RBAC**, **ESLint + Prettier**, **Husky + Commitlint** e **Jest + Supertest** totalmente integrado.

	**Objetivo:** servir como base profissional Nest-like em JavaScript puro, pronto para freelas, provas tÃ©cnicas e projetos reais.

---

## ğŸš€ InÃ­cio RÃ¡pido

```bash
# 1. Clone e instalaÃ§Ã£o
git clone https://github.com/GabrielDream/vanilla-nestlike-template.git
cd vanilla-nestlike-template
npm install

# 2. ConfiguraÃ§Ã£o de ambiente
cp .env.example .env
cp .env.test.example .env.test

# 3. Banco de dados
npx prisma db push
npm run db:seed

# 4. Desenvolvimento
npm run dev
# Servidor: http://localhost:3050

## ğŸ§° Stack Principal
Runtime: Node.js (ESM)
Framework: Express 5
ORM: Prisma (PostgreSQL)
Auth: JWT + RBAC
Testing: Jest + Supertest
Code Quality: ESLint + Prettier + Husky
Security: Bcrypt + CORS

##ğŸ“¦ Scripts Principais
json
{
  "dev": "nodemon server.js",
  "start": "node server.js",
  "test": "jest --runInBand",
  "lint": "eslint .",
  "lint:fix": "eslint . --fix",
  "format": "prettier . --write",
  "db:push": "prisma db push",
  "db:seed": "node prisma/seed.js",
  "prepare": "husky"
}

##ğŸ—„ï¸ Banco de Dados
Schema Principal (User):
id (UUID), name, email (unique, case-insensitive)
passwordHash, age (optional), role (ADMIN | STAFF)
createdAt, updatedAt

Comandos:
npx prisma generate    # Gerar client
npx prisma db push     # Aplicar schema
npm run db:seed        # Dados iniciais


##ğŸ›¡ï¸ Sistema de AutenticaÃ§Ã£o
JWT Tokens
Assinatura com signJwt(payload)

VerificaÃ§Ã£o com verifyJwt(token)

Denylist em memÃ³ria para revogaÃ§Ã£o

Guards
authRequired - Verifica token vÃ¡lido
allowRoles(['ADMIN']) - RBAC bÃ¡sico
isSelfOrRoles(['ADMIN']) - Self-update + admin override

##ğŸ”Œ Rotas da API
AutenticaÃ§Ã£o
MÃ©todo	Rota	ProteÃ§Ã£o	DescriÃ§Ã£o
POST	/auth/register	PÃºblica	Cria usuÃ¡rio STAFF
POST	/auth/login	PÃºblica	Login â†’ JWT
POST	/auth/logout	Auth	Revoga token
GET	/auth/me	Auth	UsuÃ¡rio logado
UsuÃ¡rios & RBAC
MÃ©todo	Rota	ProteÃ§Ã£o	DescriÃ§Ã£o
GET	/users	ADMIN	Lista todos usuÃ¡rios
PUT	/users/me	STAFF	Atualiza prÃ³prio perfil
DELETE	/users/me	STAFF	Auto-deleÃ§Ã£o
PUT	/admin/users/:id	ADMIN	Atualiza STAFF
DELETE	/admin/users/:id	ADMIN	Deleta STAFF
GET	/users/check-email	PÃºblica	Verifica email


## ORDEM NARRATIVA:
1ï¸âƒ£ FundaÃ§Ã£o do Projeto
    â€ƒREADME Â· package.json Â· .gitignore

2ï¸âƒ£ Ambiente e Config SensÃ­veis
â€ƒ.env Â· .env.test

3ï¸âƒ£ Pipeline de Qualidade e SemÃ¢ntica
â€ƒ.editorconfig Â· eslint.config Â· .eslintignore Â· .prettierrc Â· pre-commit Â· commit-msg Â· husky.sh Â· commitlint.config.js Â· logger.js Â· spyConsole.js

4ï¸âƒ£ Banco de Dados (Prisma)
â€ƒschema.prisma Â· migrations/ Â· seed.js Â· prisma.js

5ï¸âƒ£ Middleware Helpers
â€ƒsuccess.js Â· successHandler.js Â· AppError.js Â· errorHandler.js (+ tests)

6ï¸âƒ£ ConfiguraÃ§Ã£o Global e Testes
â€ƒjest.config.cjs Â· jest.setup.env.cjs Â· globalSetup.cjs

7ï¸âƒ£ Testes de Integridade de Banco
â€ƒuser.db.test.js Â· app.bridge.userToDb.js Â· bridge.http.test.js

8ï¸âƒ£ JWT Core
â€ƒsignJwt.js Â· verifyJwt.js (+ tests)

9ï¸âƒ£ JWT Denylist (RevogaÃ§Ã£o)
â€ƒtokenDenylist.memory.js (+ tests)

ğŸ”Ÿ JWT Guards
â€ƒauthRequired.js Â· allowRoles.js Â· isSelfOrRoles.js (+ tests)

1ï¸âƒ£1ï¸âƒ£ Rotas de Auth
â€ƒsanitize Â· register Â· login Â· logout Â· me (+ tests HTTP)

1ï¸âƒ£2ï¸âƒ£ Rotas de UsuÃ¡rio com RBAC
â€ƒlist Â· checkEmail Â· meDelete Â· adminDeleteStaff (+ tests)

1ï¸âƒ£3ï¸âƒ£ Servidor Final
â€ƒapp.js Â· server.js (+ config de listen / shutdown / Postman) âœ…



##ğŸ§ª Testes Automatizados
Cobertura Completa:

âœ… Middlewares (success/error handlers)

âœ… JWT Core (sign/verify/revogaÃ§Ã£o)

âœ… Guards (authRequired, allowRoles, isSelfOrRoles)

âœ… Auth Routes (register, login, logout, me)

âœ… User Routes + RBAC (CRUD completo)

âœ… Integridade do Banco


# Executar testes
npm test

# Teste especÃ­fico
npm test -- -t "admin delete"

##ğŸ—ï¸ Estrutura do Projeto
src/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ guards/          # authRequired, allowRoles, isSelfOrRoles
â”‚   â”œâ”€â”€ routes/          # register, login, logout, me
â”‚   â””â”€â”€ tokens/          # JWT sign/verify/denylist
â”œâ”€â”€ users/
â”‚   â”œâ”€â”€ adminRoutes/     # adminUpdateStaff, adminDeleteStaff
â”‚   â”œâ”€â”€ staffRoutes/     # updateUserStaff, deleteUserStaff
â”‚   â””â”€â”€ db/              # prisma.js
â”œâ”€â”€ utils/               # sanitize.js
â””â”€â”€ middlewares/         # success/error handlers, AppError
âš™ï¸ Qualidade de CÃ³digo
ESLint + Prettier configurados

Husky + Commitlint para commits semÃ¢nticos

Conventional Commits padrÃ£o

EditorConfig para consistÃªncia


	**Autor:** Gabriel Bussab
	**Contato:** https://www.linkedin.com/in/gabriel-bussab
  **PropÃ³sito:** DemonstraÃ§Ã£o tÃ©cnica para freelas e provas prÃ¡ticas.
