# ğŸ§  VANILLA NEST-LIKE BACKEND TEMPLATE

Backend template in **Node.js (ESM)** with **Express 5**, **Prisma (PostgreSQL)**, **JWT Auth**, **RBAC**, **ESLint + Prettier**, **Husky + Commitlint** and **Jest + Supertest** fully integrated.

**Objective:** serve as a professional Nest-like base in pure JavaScript, ready for freelancing, technical tests and real projects.

---

## ğŸš€ Quick Start

```bash
# 1. Clone and install
git clone https://github.com/GabrielDream/vanilla-nestlike-template.git
cd vanilla-nestlike-template
npm install

# 2. Environment configuration
cp .env.example .env
cp .env.test.example .env.test

# 3. Database setup
npx prisma db push
npm run db:seed

# 4. Development
npm run dev
# Server: http://localhost:3050

ğŸ§° Main Stack
Runtime: Node.js (ESM)

Framework: Express 5

ORM: Prisma (PostgreSQL)

Auth: JWT + RBAC

Testing: Jest + Supertest

Code Quality: ESLint + Prettier + Husky

Security: Bcrypt + CORS


ğŸ“¦ Main Scripts
{
  "dev": "nodemon server.js",
  "start": "node server.js",
  "test": "jest --runInBand",
  "lint": "eslint .",
  "lint:fix": "eslint . --fix",
  "format": "prettier . --write",
  "db:push": "prisma db push",
  "db:seed": "node prisma/seed.js",
  "prepare": "husky"
}

ğŸ—„ï¸ Database
Main Schema (User):

id (UUID), name, email (unique, case-insensitive)

passwordHash, age (optional), role (ADMIN | STAFF)

createdAt, updatedAt

Commands:
	npx prisma generate    # Generate client
	npx prisma db push     # Apply schema
	npm run db:seed        # Initial data

ğŸ›¡ï¸ Authentication System
JWT Tokens
Signing with signJwt(payload)

Verification with verifyJwt(token)

In-memory denylist for revocation

Guards
authRequired - Validates token

allowRoles(['ADMIN']) - Basic RBAC

isSelfOrRoles(['ADMIN']) - Self-update + admin override

ğŸ”Œ API Routes
Authentication
Method	Route	Protection	Description
POST	/auth/register	Public	Creates STAFF user
POST	/auth/login	Public	Login â†’ JWT
POST	/auth/logout	Auth	Revokes token
GET	/auth/me	Auth	Logged user
Users & RBAC
Method	Route	Protection	Description
GET	/users	ADMIN	Lists all users
PUT	/users/me	STAFF	Updates own profile
DELETE	/users/me	STAFF	Self-deletion
PUT	/admin/users/:id	ADMIN	Updates STAFF
DELETE	/admin/users/:id	ADMIN	Deletes STAFF
GET	/users/check-email	Public	Checks email
ğŸ§ª Automated Tests
Complete Coverage:

âœ… Middlewares (success/error handlers)

âœ… JWT Core (sign/verify/revocation)

âœ… Guards (authRequired, allowRoles, isSelfOrRoles)

âœ… Auth Routes (register, login, logout, me)

âœ… User Routes + RBAC (Complete CRUD)

âœ… Database Integrity


# Run tests
npm test

## ğŸ—ï¸ Project Structure
|-- .COMMANDS
|-- .editorconfig
|-- .env
|-- .env.example
|-- .env.test
|-- .env.test.example
|-- .eslintignore
|-- .gitignore
|-- .husky
|   |-- _
|   |   |-- .gitignore
|   |   |-- applypatch-msg
|   |   |-- commit-msg
|   |   |-- h
|   |   |-- husky.sh
|   |   |-- post-applypatch
|   |   |-- post-checkout
|   |   |-- post-commit
|   |   |-- post-merge
|   |   |-- post-rewrite
|   |   |-- pre-applypatch
|   |   |-- pre-auto-gc
|   |   |-- pre-commit
|   |   |-- pre-merge-commit
|   |   |-- pre-push
|   |   |-- pre-rebase
|   |   `-- prepare-commit-msg
|   |-- commit-msg
|   `-- pre-commit
|-- .prettierrc
|-- README
|-- _tests_
|   |-- MiddlewareHelpers
|   |   |-- errorHandler.test.js
|   |   `-- successHandler.test.js
|   |-- auth
|   |   |-- authRoutes
|   |   |   |-- auth.login.http.test.js
|   |   |   |-- auth.logout.http.test.js
|   |   |   |-- auth.me.http.test.js
|   |   |   `-- auth.register.http.test.js
|   |   `-- authenticationConfig
|   |       |-- allowRoles.test.js
|   |       |-- authGuards.test.js
|   |       |-- authRequired.test.js
|   |       |-- isSelfOrRoles.test.js
|   |       |-- signJwt.test.js
|   |       |-- tokenDenylist.memory.test.js
|   |       `-- verifyJwt.test.js
|   |-- bridgeUserRouteTest
|   |   |-- app.bridge.userToDb.js
|   |   `-- bridge.http.test.js
|   |-- setup
|   |   `-- globalSetup.cjs
|   `-- userRoutes
|       |-- adminDeleteAllStaffRoute.test.js
|       |-- adminUpdateAllStaffRoute.test.js
|       |-- checkEmailRoute.prisma.test.js
|       |-- dbTest
|       |   `-- user.db.test.js
|       |-- deleteUserStaffRoute.test.js
|       |-- listUserRoute.test.js
|       `-- updateUserStaff.test.js
|-- commitlint.config.js
|-- eslint.config.js
|-- generated
|   `-- prisma
|       |-- client.d.ts
|       |-- client.js
|       |-- default.d.ts
|       |-- default.js
|       |-- edge.d.ts
|       |-- edge.js
|       |-- index-browser.js
|       |-- index.d.ts
|       |-- index.js
|       |-- package.json
|       |-- query_engine-windows.dll.node
|       |-- runtime
|       |   |-- edge-esm.js
|       |   |-- edge.js
|       |   |-- index-browser.d.ts
|       |   |-- index-browser.js
|       |   |-- library.d.ts
|       |   |-- library.js
|       |   |-- react-native.js
|       |   |-- wasm-compiler-edge.js
|       |   `-- wasm-engine-edge.js
|       |-- schema.prisma
|       |-- wasm.d.ts
|       `-- wasm.js
|-- jest.config.cjs
|-- jest.setup.env.cjs
|-- middlewares
|   |-- AppError.js
|   |-- errorHandler.js
|   |-- success.js
|   `-- successHandler.js
|-- package-lock.json
|-- package.json
|-- prisma
|   |-- migrations
|   |   |-- 20250905174117_init
|   |   |   `-- migration.sql
|   |   |-- 20250905174316_email_ci_rules
|   |   |   `-- migration.sql
|   |   |-- 20250905175224_email_lowercase_ci
|   |   |   `-- migration.sql
|   |   `-- migration_lock.toml
|   |-- schema.prisma
|   `-- seed.js
|-- server.js
|-- src
|   |-- app.js
|   |-- auth
|   |   |-- guards
|   |   |   |-- allowRoles.js
|   |   |   |-- authRequired.js
|   |   |   `-- isSelfOrRoles.js
|   |   |-- routes
|   |   |   |-- getMeRoute.js
|   |   |   |-- loginRoute.js
|   |   |   |-- logoutRoute.js
|   |   |   `-- registerRoute.js
|   |   `-- tokens
|   |       |-- signJwt.js
|   |       |-- tokenDenylist.memory.js
|   |       `-- verifyJwt.js
|   |-- users
|   |   |-- adminRoutes
|   |   |   |-- adminDeleteAllStaffRoute.js
|   |   |   `-- adminUpdateAllStaffRoute.js
|   |   |-- db
|   |   |   `-- prisma.js
|   |   |-- emailCheckRoute.js
|   |   |-- listUsersRoute.js
|   |   `-- staffRoutes
|   |       |-- deleteUserStaff.js
|   |       `-- updateUserStaff.js
|   `-- utils
|       `-- sanitize.js
`-- terminalStylization
    |-- logger.js
    `-- spyConsole.js


ğŸ“– Project Narrative Order
1ï¸âƒ£ Project Foundation
â€ƒREADME Â· package.json Â· .gitignore

2ï¸âƒ£ Environment and Sensitive Config
â€ƒ.env Â· .env.test

3ï¸âƒ£ Quality and Semantic Pipeline
â€ƒ.editorconfig Â· eslint.config Â· .prettierrc Â· husky Â· commitlint

4ï¸âƒ£ Database (Prisma)
â€ƒschema.prisma Â· migrations/ Â· seed.js Â· prisma.js

5ï¸âƒ£ Middleware Helpers
â€ƒsuccess.js Â· successHandler.js Â· AppError.js Â· errorHandler.js (+ tests)

6ï¸âƒ£ Global Configuration and Tests
â€ƒjest.config.cjs Â· jest.setup.env.cjs Â· globalSetup.cjs

7ï¸âƒ£ Database Integrity Tests
â€ƒuser.db.test.js Â· app.bridge.userToDb.js Â· bridge.http.test.js

8ï¸âƒ£ JWT Core
â€ƒsignJwt.js Â· verifyJwt.js (+ tests)

9ï¸âƒ£ JWT Denylist (Revocation)
â€ƒtokenDenylist.memory.js (+ tests)

ğŸ”Ÿ JWT Guards
â€ƒauthRequired.js Â· allowRoles.js Â· isSelfOrRoles.js (+ tests)

1ï¸âƒ£1ï¸âƒ£ Auth Routes
â€ƒsanitize Â· register Â· login Â· logout Â· me (+ HTTP tests)

1ï¸âƒ£2ï¸âƒ£ User Routes with RBAC
â€ƒlist Â· checkEmail Â· meDelete Â· adminDeleteStaff (+ tests)

1ï¸âƒ£3ï¸âƒ£ Final Server
â€ƒapp.js Â· server.js (+ listen/shutdown config)

âš™ï¸ Code Quality
ESLint + Prettier configured

Husky + Commitlint for semantic commits

Conventional Commits standard

EditorConfig for consistency

Author: Gabriel Bussab
Contact: LinkedIn
Purpose: Technical demonstration for freelancing and practical tests.
